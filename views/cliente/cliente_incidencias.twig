{% extends 'layout.twig' %}

{% block title 'incidencias del cliente' %}

{% block contenido %}
    <div class="contenido">
        <form class="" action="" method="post">
            <div class="vistaFormulario">
                {% if tipo == '1' %}
                    <p class="alert alert-primary">Incidencias del cliente: {{ dniCliente }}</p>
                {% elseif tipo == '0' %}
                    <p class="alert alert-primary">Todas las incidencias</p>
                {% endif %}
            </div>

            {% if tipo == '1' %}
                <div class="vistaFormulario">
                    <input class="btn btn-primary" type="submit" name="btnVolver" value="Volver">
                </div>
            {% endif %}

            {% if mensaje == 'Si' %}
                <div class="contenedorTabla">
                    <table id="miTablaControlador" class="table table-bordered table-sm miTabla table-responsive-xl">
                        <thead class="miThead">
                        <tr>
                            <th>Id</th>
                            <th>Creada</th>
                            {#<th>técnico</th>#}
                            <th>Creacion</th>
                            <th>Resolución</th>
                            <th>Disponible</th>
                            <th>Tipo</th>
                            {#<th>Estado</th>#}
                            {#<th>Reincidencia</th>#}
                            {#<th>Otros</th>#}


                        </tr>
                        </thead>

                        {#le pasamos la variable que contiene el array con las filas de la consulta#}
                        {% for fila in arrayFilas %}
                            <tr>
                                <td>{{ fila.id_incidencia }}</td>
                                <td>{{ fila.usuario }}</td>
                                {#<td>{{ fila.tecnico }}</td>#}
                                <td>{{ fila.fecha_creacion }}</td>
                                <td>{{ fila.fecha_resolucion }}</td>
                                <td>{{ fila.proxima_llamada }}</td>
                                <td>
                                    {% if fila.tipo == 'averia' %}
                                        Averia
                                    {% elseif fila.tipo == 'cambiodomicilio' %}
                                        Cambio de domicilio
                                    {% elseif fila.tipo == 'baja' %}
                                        Baja
                                    {% elseif fila.tipo == 'instalacion' %}
                                        Instalación
                                    {% endif %}
                                </td>


                            </tr>
                        {% endfor %}
                    </table>
                </div>
            {% elseif mensaje == 'No' %}
                <div class="vistaFomulario">
                    <label class="alert alert-primary">El cliente: {{ dniCliente }}, no tiene incidencias en este momento</label>
                </div>
            {% endif %}
        </form>

    </div>
{% endblock %}

{% block usuario %}
 <span>Conectado como: {{ usuario }}</span>
{% endblock %}